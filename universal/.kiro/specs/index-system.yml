# Spec: åˆ†å½¢å¤šçº§ç´¢å¼•ç³»ç»Ÿè§„æ ¼å®šä¹‰
# Project: project-multilevel-index
# Version: 2.1.0
# Description: GEB å¯å‘çš„åˆ†å½¢è‡ªæŒ‡æ–‡æ¡£ç³»ç»Ÿ,è‡ªåŠ¨ç»´æŠ¤ PROJECT_INDEXã€FOLDER_INDEX å’Œæ–‡ä»¶å¤´æ³¨é‡Š

name: project-multilevel-index
version: 2.1.0
description: |
  åˆ†å½¢å¤šçº§ç´¢å¼•ç³»ç»Ÿ - è‡ªæˆ‘ç»´æŠ¤çš„æ–‡æ¡£ç³»ç»Ÿ
  çµæ„Ÿæ¥æº: Douglas Hofstadter çš„ã€Šå“¥å¾·å°”ã€è‰¾èˆå°”ã€å·´èµ«ã€‹

  æ ¸å¿ƒç‰¹æ€§:
  ğŸ”„ è‡ªæˆ‘ç»´æŠ¤ - æ–‡æ¡£åŒ…å«è‡ªæŒ‡æé†’,è§¦å‘ AI è‡ªåŠ¨æ›´æ–°
  ğŸ“ åˆ†å½¢ç»“æ„ - æ¯ä¸ªå±‚çº§éµå¾ªç›¸åŒæ¨¡å¼
  ğŸ›¡ï¸ å¢é‡æ›´æ–° - å…ˆè¯»åå†™è§„åˆ™é˜²æ­¢è¦†ç›–
  ğŸ¤– å¤šç¼–è¾‘å™¨ - æ”¯æŒä¸»æµ AI ç¼–è¾‘å™¨
  ğŸŒ åŒè¯­ - ä¸­æ–‡å’Œè‹±æ–‡

# æ ¸å¿ƒæ¦‚å¿µ
concepts:
  - name: è‡ªç›¸ä¼¼æ€§ (Self-Similarity)
    description: æ¯ä¸ªå±‚çº§éƒ½æœ‰ç›¸åŒçš„ç´¢å¼•ç»“æ„ (PROJECT â†’ FOLDER â†’ FILE)
    implementation: ä¸‰å±‚ç´¢å¼•ç³»ç»Ÿ,æ¯å±‚éƒ½åŒ…å«æ¶æ„è¯´æ˜å’Œå†…å®¹æ¸…å•

  - name: è‡ªæŒ‡æ€§ (Self-Reference)
    description: æ¯ä¸ªæ–‡æ¡£éƒ½å£°æ˜"å½“æˆ‘å˜åŒ–æ—¶,æ›´æ–°æˆ‘"
    implementation: åœ¨æ–‡æ¡£ä¸­åµŒå…¥æ›´æ–°æé†’,è§¦å‘ AI è‡ªåŠ¨æ‰§è¡Œ

  - name: å¤è°ƒæ€§ (Polyphony)
    description: ä»£ç ä¸æ–‡æ¡£ç›¸äº’å‘¼åº”,å±€éƒ¨å½±å“æ•´ä½“
    implementation: æ–‡ä»¶å˜åŒ– â†’ æ›´æ–°å¤´éƒ¨ â†’ æ›´æ–°æ–‡ä»¶å¤¹ç´¢å¼• â†’ æ›´æ–°é¡¹ç›®ç´¢å¼•

# ç´¢å¼•ç»“æ„å®šä¹‰
structure:
  project_index:
    file: PROJECT_INDEX.md
    location: project_root
    sections:
      - é¡¹ç›®æ¦‚è§ˆ (3-5è¡Œç®€ä»‹)
      - æ¶æ„è¯´æ˜ (åˆ†å±‚è®¾è®¡)
      - ç›®å½•ç»“æ„ (æ ‘å½¢å±•ç¤º)
      - ä¾èµ–å…³ç³»å›¾ (Mermaid å¯è§†åŒ–)
    self_reference: "ğŸ”„ å½“é¡¹ç›®ç»“æ„å˜åŒ–æ—¶,æ›´æ–°æ­¤ç´¢å¼•"
    update_trigger: æ–°å¢/åˆ é™¤æ–‡ä»¶å¤¹, é‡å¤§æ¶æ„è°ƒæ•´

  folder_index:
    file: FOLDER_INDEX.md
    location: each_code_folder
    sections:
      - æ¶æ„è¯´æ˜ (3è¡Œæè¿°æœ¬æ–‡ä»¶å¤¹èŒè´£)
      - æ–‡ä»¶æ¸…å• (æ¯ä¸ªæ–‡ä»¶çš„ Input/Output/Pos)
    self_reference: "ğŸ”„ å½“æ–‡ä»¶å¤¹å†…å®¹å˜åŒ–æ—¶,æ›´æ–°æ­¤ç´¢å¼•"
    update_trigger: æ–°å¢/åˆ é™¤æ–‡ä»¶, æ–‡ä»¶ä¾èµ–å˜åŒ–

  file_header:
    location: each_code_file
    format: language_specific_comment
    fields:
      - name: Input
        description: ä¾èµ–çš„å¤–éƒ¨å†…å®¹ (imports, æ•°æ®æº)
      - name: Output
        description: å¯¹å¤–æä¾›çš„å†…å®¹ (exports, API)
      - name: Pos
        description: åœ¨ç³»ç»Ÿä¸­çš„å®šä½ (æ¶æ„å±‚æ¬¡, èŒè´£)
    self_reference: "ğŸ”„ æˆ‘è¢«æ›´æ–°æ—¶,æ›´æ–°æˆ‘çš„æ³¨é‡Šå’Œç´¢å¼•"
    update_trigger: import/export è¯­å¥å˜åŒ–

# è§¦å‘è§„åˆ™
triggers:
  structural_change:
    description: ç»“æ„æ€§å˜åŒ–,éœ€è¦å…¨é¢æ›´æ–°
    keywords:
      imports: [import, require, use, from, "#include", using, include_once]
      exports: [export, public, class, interface, function, def, fn, func, struct, enum]
    action: æ›´æ–°æ–‡ä»¶å¤´ + FOLDER_INDEX + PROJECT_INDEX

  header_only_change:
    description: ä»…å¤´éƒ¨æ³¨é‡Šå˜åŒ–
    detection: æ–‡ä»¶å¤´æ³¨é‡ŠåŒºåŸŸå‘ç”Ÿä¿®æ”¹
    action: ä»…æ›´æ–°æ–‡ä»¶å¤´æ³¨é‡Š

  implementation_change:
    description: ä»…å®ç°ç»†èŠ‚å˜åŒ–,æ— éœ€æ›´æ–°
    detection: é import/export, éå¤´éƒ¨æ³¨é‡Šçš„ä¿®æ”¹
    action: è·³è¿‡æ›´æ–°

# æ’é™¤è§„åˆ™
exclude:
  directories:
    - node_modules
    - .git
    - dist
    - build
    - target
    - out
    - bin
    - obj
    - .next
    - .nuxt
    - .cache
    - coverage
    - __pycache__

  files:
    - "*.min.js"
    - "*.bundle.js"
    - "*.map"
    - "*.lock"
    - package-lock.json
    - yarn.lock
    - Cargo.lock

  use_gitignore: true
  max_file_size: 512000  # 500KB

# æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€
languages:
  - name: JavaScript/TypeScript
    extensions: [.js, .jsx, .ts, .tsx, .mjs, .cjs]
    comment_style: jsdoc
    template: javascript.md

  - name: Python
    extensions: [.py]
    comment_style: docstring
    template: python.md

  - name: Java/Kotlin
    extensions: [.java, .kt, .kts]
    comment_style: javadoc
    template: java.md

  - name: Rust
    extensions: [.rs]
    comment_style: rustdoc
    template: rust.md

  - name: Go
    extensions: [.go]
    comment_style: single_line
    template: go.md

  - name: C/C++
    extensions: [.c, .cpp, .cc, .cxx, .h, .hpp, .hxx]
    comment_style: doxygen
    template: cpp.md

  - name: PHP
    extensions: [.php]
    comment_style: phpdoc
    template: php.md

  - name: Ruby
    extensions: [.rb]
    comment_style: rdoc
    template: ruby.md

  - name: Swift
    extensions: [.swift]
    comment_style: markup
    template: swift.md

  - name: C#
    extensions: [.cs]
    comment_style: xmldoc
    template: csharp.md

# æ›´æ–°ç­–ç•¥
update_strategy:
  read_before_write: true
  preserve_user_content: true
  incremental_update: true
  batch_processing: true
  silent_minor_updates: true
  notify_major_changes: true

# ä¾èµ–åˆ†æ
dependency_analysis:
  max_depth: 5
  include_third_party: false
  circular_detection: true
  visualize_with_mermaid: true
  max_graph_nodes: 50

# å›½é™…åŒ–
i18n:
  default_language: zh-CN
  supported_languages:
    - zh-CN
    - en-US
  locale_config_path: .claude/locale-config.json
